<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>commit - Eve Documentation</title>
    <meta name="generator" content="Hugo 0.16" />

    
    <link rel="canonical" href="http://docs.witheve.com/handbook/commit/">
    
    <meta name="author" content="Eve">
    

    <meta property="og:url" content="http://docs.witheve.com/handbook/commit/">
    <meta property="og:title" content="Eve Documentation">
    
    <meta name="apple-mobile-web-app-title" content="Eve Documentation">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://docs.witheve.com/images/favicon.png">
    <link rel="icon" type="image/x-icon" href="http://docs.witheve.com/images/favicon.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://docs.witheve.com/fonts/icon.eot?52m981');
        src: url('http://docs.witheve.com/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('http://docs.witheve.com/fonts/icon.woff?52m981')
               format('woff'),
             url('http://docs.witheve.com/fonts/icon.ttf?52m981')
               format('truetype'),
             url('http://docs.witheve.com/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://docs.witheve.com/stylesheets/application.css">
    <link rel="stylesheet" href="http://docs.witheve.com/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://docs.witheve.com/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://docs.witheve.com/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="http://docs.witheve.com/javascripts/modernizr.js"></script>

    

  </head>
  <body class=" ">



	
	


<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  
  <center>
    <img class="logo" src="https://witheve.github.io/assets/images/logo_square.png">
  </center>

  <div class="scrollable">
    <div class="wrapper">
      

      
      <div id="sidebar" class="nav-collapse">
          <ul class="sidebar-menu">
            
            
              
                <li class="sub-menu active">
                  <a href="http://docs.witheve.com/handbook/intro" class="">
                      
                      <span class="colored">Introduction</span>
                      <span class="menu-arrow arrow_carrot-right"></span>
                  </a>
                  <ul class="sub">
                    
                      <li><a href="http://docs.witheve.com/handbook/installation/"> Getting Eve </a> </li>
                      
                        <ul class="sub">
                          
                            <li><a href="http://docs.witheve.com/handbook/linux/">Linux</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/mac/">Mac</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/windows/">Windows</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/docker/">Docker</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/npm/">npm</a></li>
                          
                        </ul>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/running/"> Running Eve </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/help/"> Getting Help </a> </li>
                      
                    
                  </ul>
                </li>
              
            
              
                <li class="sub-menu active">
                  <a href="http://docs.witheve.com/handbook/programs" class="">
                      
                      <span class="colored">Eve Programs</span>
                      <span class="menu-arrow arrow_carrot-right"></span>
                  </a>
                  <ul class="sub">
                    
                      <li><a href="http://docs.witheve.com/handbook/model/"> Programming Model </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/sets/"> Sets </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/literate-programming/"> Literate Programming </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/blocks/"> Blocks </a> </li>
                      
                    
                  </ul>
                </li>
              
            
              
                <li class="sub-menu active">
                  <a href="http://docs.witheve.com/handbook/core" class="">
                      
                      <span class="colored">Core Language</span>
                      <span class="menu-arrow arrow_carrot-right"></span>
                  </a>
                  <ul class="sub">
                    
                      <li><a href="http://docs.witheve.com/handbook/records/"> Records </a> </li>
                      
                        <ul class="sub">
                          
                            <li><a href="http://docs.witheve.com/handbook/tags/">Tags</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/not/">not</a></li>
                          
                        </ul>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/equivalence/"> Equivalence </a> </li>
                      
                        <ul class="sub">
                          
                            <li><a href="http://docs.witheve.com/handbook/equality/">Equality</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/inequality/">Inequality</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/joins/">Joins</a></li>
                          
                        </ul>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/actions/"> Actions </a> </li>
                      
                        <ul class="sub">
                          
                            <li><a href="http://docs.witheve.com/handbook/search/">search</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/bind/">bind</a></li>
                          
                            <li class="selected"><a href="http://docs.witheve.com/handbook/commit/">commit</a></li>
                          
                        </ul>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/expressions/"> Expressions </a> </li>
                      
                        <ul class="sub">
                          
                            <li><a href="http://docs.witheve.com/handbook/functions/">Functions</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/aggregates/">Aggregates</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/if-then/">if-then</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/is/">is</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/string-interpolation/">String Interpolation</a></li>
                          
                        </ul>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/update-operators/"> Update Operators </a> </li>
                      
                        <ul class="sub">
                          
                            <li><a href="http://docs.witheve.com/handbook/add/">Add: &#43;=</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/set/">Set: :=</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/remove/">Remove: -=</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/merge/">Merge &lt;-</a></li>
                          
                        </ul>
                      
                    
                  </ul>
                </li>
              
            
              
                <li class="sub-menu active">
                  <a href="http://docs.witheve.com/handbook/databases" class="">
                      
                      <span class="colored">Databases</span>
                      <span class="menu-arrow arrow_carrot-right"></span>
                  </a>
                  <ul class="sub">
                    
                      <li><a href="http://docs.witheve.com/handbook/standard-library/"> Standard Library </a> </li>
                      
                        <ul class="sub">
                          
                            <li><a href="http://docs.witheve.com/handbook/general/">General</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/math/">Math</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/strings/">Strings</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/statistics/">Statistics</a></li>
                          
                            <li><a href="http://docs.witheve.com/handbook/datetime/">Date &amp; Time</a></li>
                          
                        </ul>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/session/"> @session </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/browser/"> @browser </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/event/"> @event </a> </li>
                      
                        <ul class="sub">
                          
                            <li><a href="http://docs.witheve.com/handbook/event/click/">click</a></li>
                          
                        </ul>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/http/"> @http </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/view/"> @view </a> </li>
                      
                    
                  </ul>
                </li>
              
            
              
                <li class="sub-menu active">
                  <a href="http://docs.witheve.com/handbook/appendix" class="">
                      
                      <span class="colored">Appendix</span>
                      <span class="menu-arrow arrow_carrot-right"></span>
                  </a>
                  <ul class="sub">
                    
                      <li><a href="http://docs.witheve.com/handbook/ebnf/"> Grammar </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/commonmark/"> CommonMark </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/handbook/glossary/"> Glossary </a> </li>
                      
                    
                  </ul>
                </li>
              
            
              
                <li class="sub-menu active">
                  <a href="http://docs.witheve.com/guides" class="">
                      
                      <span class="colored">Guides</span>
                      <span class="menu-arrow arrow_carrot-right"></span>
                  </a>
                  <ul class="sub">
                    
                      <li><a href="http://docs.witheve.com/guides/for-programmers/"> Eve for Programmers </a> </li>
                      
                    
                      <li><a href="http://docs.witheve.com/guides/style/"> Style Guide </a> </li>
                      
                    
                  </ul>
                </li>
              
            
              
                <li class="sub-menu active">
                  <a href="http://docs.witheve.com/tutorials" class="">
                      
                      <span class="colored">Tutorials</span>
                      <span class="menu-arrow arrow_carrot-right"></span>
                  </a>
                  <ul class="sub">
                    
                      <li><a href="http://docs.witheve.com/tutorials/quickstart/"> Quickstart </a> </li>
                      
                    
                  </ul>
                </li>
              
            
          </ul>
      </div>

    </div>
  </div>
</nav>
	</div>
	<article class="article">
		<div class="wrapper">

			

<h1 id="commit">commit</h1>

<p>updates or creates records that persist until intentionally removed</p>

<h2 id="syntax">Syntax</h2>
<div class="highlight"><pre><code class="language-eve" data-lang="eve"><span></span><span class="kr">commit</span><span class="w"></span>

<span class="kr">commit</span><span class="w"> </span><span class="nt">@database1</span><span class="p">,</span><span class="w"> </span><span class="x">...</span><span class="p">,</span><span class="w"> </span><span class="nt">@databaseN</span><span class="w"></span>
</code></pre></div>

<h2 id="description">Description</h2>

<p><code>commit</code> updates or creates new records that persist in a database until they are intentionally removed. If supporting records change or are removed, the original committed records remain in tact, and can still be searched by other blocks. By default, committed records are directed to a local database.</p>

<p><code>commit @database1, ..., @databaseN</code> directs committed records one or more databases.</p>

<h2 id="bind-vs-commit">Bind vs. Commit</h2>

<p>While bind and commit both update records in a database, they do so with slightly different behavior; a bound record has the same lifetime as its supporting records, whereas a committed record exists in the database until it is removed intentionally. Let&rsquo;s take a closer look at this distinction and what the implications are.</p>

<p>Consider the following block that reads the current time, and prints it to the screen:</p>
<div class="highlight"><pre><code class="language-eve" data-lang="eve"><span></span><span class="kr">search</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="nt">#time</span><span class="w"> </span><span class="x">seconds</span><span class="p">]</span><span class="w"></span>

<span class="kr">bind</span><span class="w"> </span><span class="nt">@browser</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="nt">#div</span><span class="w"> </span><span class="x">text</span><span class="nf">:</span><span class="w"> </span><span class="x">seconds</span><span class="p">]</span><span class="w"></span>
</code></pre></div>

<p>In this block we search for the current time and bind it to a message that displays it. The message exists as long as the current time stays the same (1 second obviously). When the time changes, the current message disappears and is replaced with a new message, displaying the new time. This is the behavior of bind; <strong>bound records persist only as long as their matching records</strong>.</p>

<p>Now let&rsquo;s look at what commit does in contrast:</p>
<div class="highlight"><pre><code class="language-eve" data-lang="eve"><span></span><span class="kr">search</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="nt">#time</span><span class="w"> </span><span class="x">seconds</span><span class="p">]</span><span class="w"></span>

<span class="kr">commit</span><span class="w"> </span><span class="nt">@browser</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="nt">#div</span><span class="w"> </span><span class="x">text</span><span class="nf">:</span><span class="w"> </span><span class="x">seconds</span><span class="p">]</span><span class="w"></span>
</code></pre></div>

<p>Compared to the previous block, we only changed <code>bind</code> to <code>commit</code>. When you run this block, at first you&rsquo;ll see a single message like before. However, you&rsquo;ll notice that messages begin to accumulate every second. Unlike with bind, <strong>committed records persist in the database until they are intentionally removed</strong>.</p>

<p>To make things very concrete, we can actually mimic the behavior of a bind using two blocks that commit. We&rsquo;ve already got the first one (the one just above), that commits messages to <code>@browser</code>. Now all we need is a second block, one that removes old committed messages from <code>@browser</code>:</p>
<div class="highlight"><pre><code class="language-eve" data-lang="eve"><span></span><span class="kr">search</span><span class="w"> </span>
<span class="w">  </span><span class="p">[</span><span class="nt">#time</span><span class="w"> </span><span class="x">seconds</span><span class="p">]</span><span class="w"></span>

<span class="kr">search</span><span class="w"> </span><span class="nt">@browser</span><span class="w"></span>
<span class="w">  </span><span class="x">s</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="x">seconds</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
<span class="w">  </span><span class="c1">// Do some math to handle the roll over at 60 seconds</span><span class="w"></span>
<span class="w">  </span><span class="x">last</span><span class="nf">-</span><span class="x">time</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="x">s</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="m">60</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="x">floor</span><span class="p">[</span><span class="x">value</span><span class="nf">:</span><span class="w"> </span><span class="x">s</span><span class="w"> </span><span class="nf">/</span><span class="w"> </span><span class="m">60</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="x">msg</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">[</span><span class="nt">#div</span><span class="w"> </span><span class="x">text</span><span class="nf">:</span><span class="w"> </span><span class="x">last</span><span class="nf">-</span><span class="x">time</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span>
<span class="kr">commit</span><span class="w"> </span><span class="nt">@browser</span><span class="w"></span>
<span class="w">  </span><span class="x">msg</span><span class="w"> </span><span class="nf">:=</span><span class="w"> </span><span class="kr">none</span><span class="w"></span>
</code></pre></div>

<p>This block searches for the message that was displayed during the previous second, and sets it to <code>none</code>, thereby removing it from <code>@browser</code>. Therefore, only the message bound to the the current time is displayed on the screen. This behavior is identical to that of the block that binds these messages instead of committing them!</p>

<h3 id="an-execution-perspective">An Execution Perspective</h3>

<p>Another way to understand <code>bind</code> vs. <code>commit</code> is by looking at how the databases change over each tick of the Eve evaluator. We&rsquo;ll consider the same program as before, looking at how its state changes over time. First, consider the bind case. When the program starts, there&rsquo;s nothing in any databases; the program is a blank slate. At <code>t1</code> the first <code>#time</code> is added to <code>@session</code>. This addition is bound to a <code>#div</code>, which is added to <code>@browser</code>. These changes are summarized in the first column of the table below.</p>

<p>At <code>t2</code>, a new <code>#time</code> is added to <code>@session</code>, and the one from <code>t1</code> is removed. Since we used a bind, this causes the existing <code>#div</code> to be removed from <code>@browser</code>, but it is replaced with a new <code>#div</code> reflecting the current time. At <code>t3</code>, the same operations takes place, and this process continues until the program is terminated.</p>

<table class="dataTable">
  <tr>
    <th>
       
    </th>
    <th>
t0
    </th>
    <th>
t1
    </th>
    <th>
t2
    </th>
    <th>
t3
    </th>
  </tr>
  <tr>
    <td>
delta
    </td>
    <td>

    </td>
    <td>
+ [#time seconds: 39]
+ [#div text: "39"]
    </td>
    <td>
+ [#time seconds: 40]
- [#time seconds: 39]
+ [#div text: "40"]
- [#div text: "39"]
    </td>
    <td>
+ [#time seconds: 41]
- [#time seconds: 40]
+ [#div text: "41"]
- [#div text: "40"]
    </td>  
  </tr>
  <tr>
    <td>
@session
    </td>
    <td>
[ ]
    </td>
    <td>
[[#time seconds: 39]]
    </td>
    <td>
[[#time seconds: 40]]
    </td>
    <td>
[[#time seconds: 41]]
    </td>  
  </tr>
  <tr>
    <td>
@browser
    </td>
    <td>
[ ]
    </td>
    <td>
[[#div text: 39]]
    </td>
    <td>
[[#div text: 40]]
    </td>
    <td>
[[#div text: 41]]
    </td>  
  </tr>
</table>

<p>Let&rsquo;s perform the same analysis in the commit case. In this program, things start off the same; initially the database is empty, and at <code>t1</code> a <code>#time</code> and a <code>#div</code> are added to their respective databases. At <code>t2</code>, things get more interesting. While the old <code>#time</code> is still replaced, the <code>#div</code> displaying the old time is not replaced since we committed it to <code>@browser</code>. Indeed, in subsequent rounds of execution, the contents of <code>@browser</code> keeps growing.</p>

<table class="dataTable">
  <tr>
    <th>
       
    </th>
    <th>
t0
    </th>
    <th>
t1
    </th>
    <th>
t2
    </th>
    <th>
t3
    </th>
  </tr>
  <tr>
    <td>
delta
    </td>
    <td>
    </td>
    <td>
+ [#time seconds: 39]
+ [#div text: "39"]
    </td>
    <td>
+ [#time seconds: 40]
- [#time seconds: 39]
+ [#div text: "40"]
    </td>
    <td>
+ [#time seconds: 41]
- [#time seconds: 40]
+ [#div text: "41"]
    </td>  
  </tr>
  <tr>
    <td>
@session
    </td>
    <td>
[ ]
    </td>
    <td>
[[#time seconds: 39]]
    </td>
    <td>
[[#time seconds: 40]]
    </td>
    <td>
[[#time seconds: 41]]
    </td>  
  </tr>
  <tr>
    <td>
@browser
    </td>
    <td>
[ ]
    </td>
    <td>
[[#div text: 39]]
    </td>
    <td>
[[#div text: 39],
 [#div text: 40]]
    </td>
    <td>
[[#div text: 39], 
 [#div text: 40], 
 [#div text: 41]]
    </td>  
  </tr>
</table>

<h2 id="tips">Tips</h2>

<p>When you want to display data in an interface element like a <code>#div</code>, a bind is usually the more appropriate choice compared to a commit. A bind will keep the interface element always up-to-date, whereas a commit will leave lingering elements that no longer reflect the current state of the program.</p>

<p>When searching for an event like a <code>#click</code>, a commit is usually more appropriate than bind. When an event occurs, a record representing the event is added to a database. That record exists for exactly one &ldquo;instant&rdquo;, and then it is removed from the database. During that &ldquo;instant&rdquo;, any block searching for that event will be satisfied and can execute a bind or commit action. If you <code>bind</code> on the event, then the result will disappear as soon as the event does. However, if you <code>commit</code> on the event, then that result will persist after the event has been removed.</p>

<h2 id="examples">Examples</h2>

<p>Initialize a counter when a session connects</p>
<div class="highlight"><pre><code class="language-eve" data-lang="eve"><span></span><span class="kr">search</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="nt">#session-connect</span><span class="p">]</span><span class="w"></span>

<span class="kr">commit</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="nt">#counter</span><span class="w"> </span><span class="x">count</span><span class="nf">:</span><span class="w"> </span><span class="m">0</span><span class="p">]</span><span class="w"></span>
</code></pre></div>

<p>Increment a counter when a button is clicked</p>
<div class="highlight"><pre><code class="language-eve" data-lang="eve"><span></span><span class="kr">search</span><span class="w"></span>
<span class="w">  </span><span class="p">[</span><span class="nt">#click</span><span class="w"> </span><span class="x">element</span><span class="nf">:</span><span class="w"> </span><span class="p">[</span><span class="nt">#count-button</span><span class="w"> </span><span class="x">diff</span><span class="w"> </span><span class="x">counter</span><span class="p">]]</span><span class="w"></span>

<span class="kr">commit</span><span class="w"></span>
<span class="w">  </span><span class="x">counter.count</span><span class="w"> </span><span class="nf">:=</span><span class="w"> </span><span class="x">counter.count</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="x">diff</span><span class="w"></span>
</code></pre></div>

<h2 id="see-also">See Also</h2>

<p><a href="../bind">bind</a> | <a href="../databases">databases</a> | <a href="../search">search</a></p>


		</div>
	</article>

</main>

